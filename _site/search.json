[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Yojan Alcaraz´s Blog",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n  \n\n\n\n\nPost With Code\n\n\n\n\n\n\n\nNews\n\n\nCode\n\n\nAnalysis\n\n\n\n\n\n\n\n\n\n\n\nJan 23, 2023\n\n\nHarlow Malloc\n\n\n\n\n\n\n  \n\n\n\n\nFirst document\n\n\n\n\n\n\n\nNews\n\n\nAcademic\n\n\n\n\n\n\n\n\n\n\n\nJan 20, 2023\n\n\nYojan Alcaraz\n\n\n\n\n\n\n  \n\n\n\n\nFirstPost\n\n\n\n\n\n\n\nNews\n\n\n\n\n\n\n\n\n\n\n\nJan 20, 2023\n\n\nYojan Alcaraz\n\n\n\n\n\n\n  \n\n\n\n\nWelcome To My Blog\n\n\n\n\n\n\n\nNews\n\n\n\n\n\n\n\n\n\n\n\nJan 20, 2023\n\n\nTristan O’Malley\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Hi! I´m Yojan Alcaraz, a student of Statistics at the National University of Colombia.\n\n\nNacional University of Colombia, Medellín | Antioquia, Colombia | Statistics Undergraduate | Aug 2018 - Present\n\n\n\nAdd experience"
  },
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "Post With Code",
    "section": "",
    "text": "This is a post with executable code.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!\n\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts."
  },
  {
    "objectID": "posts/first-post/index.html",
    "href": "posts/first-post/index.html",
    "title": "FirstPost",
    "section": "",
    "text": "Hi, This is my first post"
  },
  {
    "objectID": "posts/documento/index.html",
    "href": "posts/documento/index.html",
    "title": "First document",
    "section": "",
    "text": "Codelibrary(boot)\nlibrary(ggplot2)\nlibrary(lme4)\nlibrary(magrittr)\nlibrary(rmarkdown)\nlibrary (foreign)\nlibrary(HSAUR2)\nlibrary(dplyr)\n\n\nEste documento contiene el desarrollo a un taller académico de la asignatura Modelos Jerárquicos.\n\nLa base de datos toenail del paquete HSAUR2 contiene los resultados de un ensayo clínico para comparar dos tratamientos para combatir una infección en los dedos de los pies (dermatophyte onychomycosis).\n\nCodedata(\"toenail\")\n\n\n\nLa base de datos contiene las siguientes variables:\n\npatientID: Identificador único para cada paciente en el tratamiento.\noutcome: Grado de separación de la placa ungeal del lecho ungeal.\ntreatment: Factor con dos niveles: itraconazole y terbinafine.\ntime: Momento del mes en que se produjo la visita.\nvisit: Número de visitas atendidas.\n\nLos pacientes que asistieron solo una vez al control son los siguientes:\n\nCodesumvisits <- aggregate(visit~patientID, data = toenail, sum)\nunavez <- sumvisits[sumvisits$visit == 1,]\nunavez\n\n    patientID visit\n34         45     1\n35         48     1\n48         63     1\n77         99     1\n291       377     1\n\n\nAsí, los pacientes con identificador 45, 48, 63, 99 y 377 asistieron una única vez al control.\n\n\nCodemax(sumvisits$visit)\n\n[1] 28\n\n\nEl mayor número de visitas de un paciente es 28.\n\nLa cantidad de pacientes por tratamiento es la siguiente:\n\nCodecanti_treatment <-aggregate(visit~patientID+treatment, data = toenail, sum)\ntable(canti_treatment$treatment)\n\n\nitraconazole  terbinafine \n         146          148 \n\n\nDe los 294 pacientes, 146 pacientes fueron tratados con itraconazole y 148 fueron tratados con terbinafine.\n\nEl gráfico de la evolución del estado de la enfermedad \\(Y\\) en función del tiempo para los pacientes 1, 3, 21 y 383 es el siguiente:\n\nCodegrafico <- toenail[toenail$patientID %in% c(1,3,21,383),]\ngrafico$outcome <- ifelse(grafico$outcome == \"none or mild\",1,0)\nggplot(data = grafico, aes(x = time, y = outcome, color = treatment)) +\n  geom_point() + theme_bw() + facet_wrap(~ patientID) + \n  labs(y = \"y\",color = \"treatment\") \n\n\n\n\n\n\n\nEntre los cuatro pacientes analizados en el gráfico, el único paciente que fue tratado con itraconazole fue el paciente 3 y fue el único paciente que durante el tiempo de visitas tuvo una desmejoría respecto a la evolución del estado de la enfermedad, los otros tres pacientes tratados con terbinafine mejoraron luego de determinados días de visita: el paciente 1 mejoró en la cuarta visita, el paciente 21 mejoró en la tercer visita y el paciente 383 tuvo una mejoría en la visita 5.\n\nCon la siguiente línea de código se ajusta el modelo con la estructura\n\\[\\begin{align*}\ny_{ij} &\\sim  Bernoulli(p_{ij}) \\\\\n\\text{logit}(p_{ij}) &= \\beta_0 + \\beta_1 \\, time_{ij} + \\beta_2 \\, treatment_{itraconazolei} + b_{0i} \\\\\nb_0 &\\sim N(0, \\sigma^2_{b0}),\n\\end{align*}\\]\ndonde \\(i\\) corresponde al paciente y \\(j\\) a la visita.\n\nCodetoenail$outcome <- ifelse(toenail$outcome == \"none or mild\",1,0)\n# Cambiar tratamiento de referencia:\ntoenail$treatment <- relevel(toenail$treatment, ref = 2)\nmod1 <- glmer(outcome ~ 1 + time + treatment + (1 | patientID), \n              data = toenail, family = binomial(link = \"logit\"), nAGQ = 1)\n\n\nEl siguiente es el resumen del modelo 1:\n\nCodesummary(mod1)\n\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: outcome ~ 1 + time + treatment + (1 | patientID)\n   Data: toenail\n\n     AIC      BIC   logLik deviance df.resid \n  1267.6   1289.9   -629.8   1259.6     1904 \n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-30.1541   0.0088   0.0740   0.1399   3.7315 \n\nRandom effects:\n Groups    Name        Variance Std.Dev.\n patientID (Intercept) 20.73    4.553   \nNumber of obs: 1908, groups:  patientID, 294\n\nFixed effects:\n                      Estimate Std. Error z value Pr(>|z|)    \n(Intercept)            3.00496    0.79649   3.773 0.000161 ***\ntime                   0.46094    0.03962  11.633  < 2e-16 ***\ntreatmentitraconazole -0.68556    0.65899  -1.040 0.298198    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) time  \ntime         0.330       \ntrtmnttrcnz -0.486 -0.081\n\n\n\nEl ajuste del modelo con estructura\n\\[\\begin{align*}\ny_{ij} &\\sim  Bernoulli(p_{ij}) \\\\\n\\text{logit}(p_{ij}) &= \\beta_0 + \\beta_1 \\, time_{ij} + \\beta_2 \\, treatment_{itraconazolei} + \\beta_3 \\, time_{ij} \\, treatment_{itraconazolei} + b_{0i} \\\\\nb_0 &\\sim N(0, \\sigma^2_{b0}),\n\\end{align*}\\]\nestá dado por las siguientes líneas de código:\n\nCodemod2 <- glmer(outcome ~ 1 + time * treatment + (1 | patientID), \n              data = toenail,family = binomial(link = \"logit\"), nAGQ = 1)\n\n\nY el resumen del modelo 2 se muestra a continuación:\n\nCodesummary(mod2)\n\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: outcome ~ 1 + time * treatment + (1 | patientID)\n   Data: toenail\n\n     AIC      BIC   logLik deviance df.resid \n  1265.6   1293.4   -627.8   1255.6     1903 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-47.216   0.006   0.071   0.149   3.290 \n\nRandom effects:\n Groups    Name        Variance Std.Dev.\n patientID (Intercept) 20.76    4.557   \nNumber of obs: 1908, groups:  patientID, 294\n\nFixed effects:\n                           Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                 2.81470    0.81453   3.456 0.000549 ***\ntime                        0.53687    0.05919   9.070  < 2e-16 ***\ntreatmentitraconazole      -0.30482    0.68710  -0.444 0.657303    \ntime:treatmentitraconazole -0.13714    0.06949  -1.973 0.048458 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) time   trtmnt\ntime         0.181              \ntrtmnttrcnz -0.493  0.137       \ntm:trtmnttr  0.053 -0.747 -0.265\n\n\n\nEl modelo dado por mod3 se ajusta con las siguientes líneas de código:\n\\[\\begin{align*}\ny_{ij} &\\sim  Bernoulli(p_{ij}) \\\\\n\\text{logit}(p_{ij}) &= \\beta_0 + \\beta_1 \\, time_{ij} + \\beta_2 \\, treatment_{itraconazolei} + \\beta_3 \\, time_{ij} \\, treatment_{itraconazolei} + b_{0i} + b_{1i} \\,time_{ij} \\\\\n\\left (\n\\begin{matrix}\nb_{0} \\\\ b_{1}\n\\end{matrix}\n\\right ) &\\sim\nN\\left ( \\left ( \\begin{matrix}\n0 \\\\ 0\n\\end{matrix} \\right ),\n\\left ( \\begin{matrix}\n\\sigma^2_{b0} & \\sigma_{b01} \\\\\n\\sigma_{b01} & \\sigma^2_{b1}\n\\end{matrix} \\right )\n\\right ) \\\\\n\\end{align*}\\]\n\nCodemod3 <- glmer(outcome ~ 1 + time * treatment + (1 + time| patientID), \n              data = toenail,family = binomial(link = \"logit\"), nAGQ = 1)\n\n\nSe muestra el resumen del modelo 3 a continuación:\n\nCodesummary(mod3)\n\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: outcome ~ 1 + time * treatment + (1 + time | patientID)\n   Data: toenail\n\n     AIC      BIC   logLik deviance df.resid \n   996.6   1035.5   -491.3    982.6     1901 \n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.36512  0.00000  0.00242  0.00661  1.95071 \n\nRandom effects:\n Groups    Name        Variance Std.Dev. Corr \n patientID (Intercept) 549.00   23.431        \n           time         14.72    3.836   -0.87\nNumber of obs: 1908, groups:  patientID, 294\n\nFixed effects:\n                           Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                 9.35034    0.85264  10.966   <2e-16 ***\ntime                        0.75546    0.35523   2.127   0.0334 *  \ntreatmentitraconazole       0.02474    1.02731   0.024   0.9808    \ntime:treatmentitraconazole -0.45704    0.34998  -1.306   0.1916    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) time   trtmnt\ntime        -0.246              \ntrtmnttrcnz -0.593  0.284       \ntm:trtmnttr  0.258 -0.795 -0.493\n\n\n\nLa función anova() permite comparar los tres modelos propuestos anteriormente:\n\nCodeanova(mod1,mod2,mod3)\n\nData: toenail\nModels:\nmod1: outcome ~ 1 + time + treatment + (1 | patientID)\nmod2: outcome ~ 1 + time * treatment + (1 | patientID)\nmod3: outcome ~ 1 + time * treatment + (1 + time | patientID)\n     npar     AIC    BIC  logLik deviance    Chisq Df Pr(>Chisq)    \nmod1    4 1267.65 1289.9 -629.82  1259.65                           \nmod2    5 1265.63 1293.4 -627.82  1255.63   4.0163  1    0.04506 *  \nmod3    7  996.63 1035.5 -491.32   982.63 273.0001  2    < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nDada esta salida, el modelo mod3 es el mejor entre los modelos propuestos.\n\nLa función predict.merMod permite realizar predicciones con modelos de efectos mixtos, una de sus argumentos es type, este permite indicar el tipo de predicción que se quiere obtener, si es en términos de la función de linkeo o en términos de la respuesta.\n\nEntre los modelos propuestos, el mejor modelo (mod3) ajustado está dado por:\n\\[\\begin{align*}\n\\widehat{Pr}(outcome_{ij} &= none \\, or \\, mild = 1) \\\\\n&= logit^{-1}(9.35034 + 0.75546 \\, time_{ij} + 0.02474 \\, treatment_{itraconazolei} - \\\\\n& 0.45704 \\, time_{ij} \\, treatment_{itraconazolei} + \\tilde{b}_{0i} + \\tilde{b}_{1i} \\,time_{ij}) \\\\\n\\left (\n\\begin{matrix}\nb_{0} \\\\ b_{1}\n\\end{matrix}\n\\right ) &\\sim\nN\\left ( \\left ( \\begin{matrix}\n0 \\\\ 0\n\\end{matrix} \\right ),\n\\left ( \\begin{matrix}\n549 & 7030.7136 \\\\\n7030.7136 & 14.72\n\\end{matrix} \\right )\n\\right ) \\\\\n\\end{align*}\\]\n\nEl modelo ajustado para el paciente 1 se muestra a continuación; las siguientes líneas de código permiten obtener los coeficientes de dicho modelo:\n\nCodecoeficientes <- coef(mod3)\ncoeficientes$patientID[1,]\n\n  (Intercept)     time treatmentitraconazole time:treatmentitraconazole\n1    -15.2814 3.855571             0.0247429                 -0.4570361\n\n\n\\[\\begin{align*}\n\\widehat{Pr}(outcome_{1j} &= none \\, or \\, mild = 1) \\\\\n&= logit^{-1}(-15.2814 + 3.8556 \\, time_{1j} + 0.02474 \\, treatment_{itraconazole_1} - \\\\\n& 0.45704 \\, time_{1j} \\, treatment_{itraconazole_1})\n\\end{align*}\\]\n\nA continuación se muestra el mismo gráfico construido en la sección 1.5, pero esta vez con la curva ajustada por cada uno de los modelos propuestos anteriormente: mod1, mod2 y mod3.\n\nGráfico para modelo 1:\n\n\nCodetoenail$predict1 <- predict(mod1, type = \"response\")\ngrafico1 <- toenail[toenail$patientID %in% c(1,3,21,383),]\nggplot(data = grafico1, aes(x = time, y = predict1, color = treatment)) +\n  geom_line()+\n  geom_point(aes(x = time, y = outcome, color = treatment)) +\n  theme_bw() +\n  facet_wrap(~ patientID) + \n  labs(y = \"y\",color = \"treatment\") \n\n\n\n\n\n\n\n\nGráfico para modelo 2:\n\n\nCodetoenail$predict2 <- predict(mod2, type = \"response\")\ngrafico2 <- toenail[toenail$patientID %in% c(1,3,21,383),]\nggplot(data = grafico2, aes(x = time, y = predict2, color = treatment)) +\n  geom_line()+\n  geom_point(aes(x = time, y = outcome, color = treatment)) +\n  theme_bw() +\n  facet_wrap(~ patientID) + \n  labs(y = \"y\",color = \"treatment\") \n\n\n\n\n\n\n\n\nGráfico para modelo 3:\n\n\nCodetoenail$predict3 <- predict(mod3, type = \"response\")\ngrafico2 <- toenail[toenail$patientID %in% c(1,3,21,383),]\nggplot(data = grafico2, aes(x = time, y = predict3, color = treatment)) +\n  geom_line()+\n  geom_point(aes(x = time, y = outcome, color = treatment)) +\n  theme_bw() +\n  facet_wrap(~ patientID) + \n  labs(y = \"y\",color = \"treatment\") \n\n\n\n\n\n\n\nLa figura presentada en el enunciado corresponde al modelo 3: mod3."
  }
]